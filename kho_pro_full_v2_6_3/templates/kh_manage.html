{% extends "base.html" %}
{% block content %}

<style>
  .toolbar { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
  .toolbar .spacer { flex:1; }
  .toolbar .right { display:flex; gap:8px; }
  .row-actions { display:flex; gap:8px; justify-content:flex-start; }
  .row-actions .btn { min-width:64px; text-align:center; }
</style>

<div class="card">
  <h2 class="card__title">üë§ Kh√°ch h√†ng</h2>

  <!-- Thanh c√¥ng c·ª• -->
  <form method="get" class="toolbar">
    <input class="input" type="text" name="q" value="{{ q or '' }}" placeholder="T√¨m theo m√£ / t√™n / SƒêT‚Ä¶">
    <button class="btn small">T√¨m</button>

    <div class="spacer"></div>

    <div class="right">
      <a class="btn small" href="{{ url_for('kh_create') }}">Th√™m kh√°ch h√†ng</a>
    </div>
  </form>

  <div class="table-wrapper" style="margin-top:8px;">
    <table class="table">
      <thead>
        <tr>
          <th>M√£</th>
          <th>H·ªç t√™n</th>
          <th>SƒêT</th>
          <th>ƒê·ªãa ƒëi·ªÉm</th>
          <th style="width:160px;">&nbsp;</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td>{{ r.id_khach_hang }}</td>
          <td>{{ (r.ho or '') ~ ' ' ~ (r.ten_dem or '') ~ ' ' ~ (r.ten or '') }}</td>
          <td>{{ r.so_dien_thoai or '‚Äî' }}</td>
          <td>
            {% if r.id_dia_chi %}
              {{ r.id_dia_chi }} - {{ r.dia_diem.ten_dia_diem }}
            {% else %}
              ‚Äî
            {% endif %}
          </td>
          <td>
            <div class="row-actions">
              <a class="btn small ghost" href="{{ url_for('kh_edit', id=r.id_khach_hang) }}">S·ª≠a</a>
              <form method="post" action="{{ url_for('kh_delete', id=r.id_khach_hang) }}"
                    onsubmit="return confirm('X√≥a kh√°ch h√†ng {{ r.id_khach_hang }}?');">
                <button class="btn small danger" type="submit">X√≥a</button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
        {% if not rows %}
        <tr><td colspan="5" style="text-align:center;opacity:.7;">Kh√¥ng c√≥ d·ªØ li·ªáu</td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
